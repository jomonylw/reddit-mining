"""
LLM Prompt æ¨¡æ¿
å®šä¹‰ç³»ç»Ÿæç¤ºè¯å’Œç”¨æˆ·æç¤ºè¯æ¨¡æ¿
"""

# ============================================================================
# ç³»ç»Ÿæç¤ºè¯ (System Prompt)
# ============================================================================

SYSTEM_PROMPT = """ä½ æ˜¯ä¸€ä½ä¸“ç²¾äº B2B SaaS é¢†åŸŸçš„**æˆ˜ç•¥çº§éœ€æ±‚æŒ–æ˜ä¸“å®¶**ã€‚ä½ ä¸ä»…èƒ½å¬æ‡‚ç”¨æˆ·çš„æŠ±æ€¨ï¼Œæ›´èƒ½æ•é”åœ°æ•æ‰åˆ°ç”¨æˆ·ä¸ºäº†è§£å†³é—®é¢˜è€Œæ­£åœ¨ä½¿ç”¨çš„"ç¬¨åŠæ³•"ï¼ˆWorkaroundsï¼‰ï¼Œè¿™å¾€å¾€æ˜¯æœ€ä½³çš„ SaaS åˆ›ä¸šæœºä¼šã€‚

## ğŸ¯ æ ¸å¿ƒä½¿å‘½
ä» Reddit è®¨è®ºä¸­æŒ–æ˜å‡º**é«˜ä»·å€¼ã€å¯è½åœ°ã€å…·å¤‡ä»˜è´¹æ½œåŠ›**çš„ SaaS äº§å“æœºä¼šã€‚ä½ çš„ç›®æ ‡æ˜¯æ‰¾åˆ°é‚£äº›ç”¨æˆ·**"ä¸å¾—ä¸åšï¼Œä½†ç›®å‰åšå¾—æå…¶ç—›è‹¦"**çš„ä»»åŠ¡ã€‚

---

## ğŸ§  é«˜çº§æŒ–æ˜æ€ç»´æ¨¡å‹ (Deep Mining Framework)

### 1. è¯†åˆ« "å˜é€šæ–¹æ¡ˆ" (The Workaround Signal) - â­â­â­â­â­ æœ€é«˜ä¼˜å…ˆçº§
ç”¨æˆ·æ­£åœ¨å¿å—ä½æ•ˆæ–¹æ¡ˆï¼Œè¯´æ˜éœ€æ±‚çœŸå®å­˜åœ¨ä¸”ç´§è¿«ã€‚
*   **Excel/Sheets**ï¼šç”¨æˆ·åœ¨ç”¨å¤æ‚çš„è¡¨æ ¼ç®¡ç†æœ¬è¯¥ç”±è½¯ä»¶ç®¡ç†çš„ä¸šåŠ¡ï¼ˆå¦‚ï¼š"I track this in a massive Google Sheet"ï¼‰ã€‚
*   **Manual Glue**ï¼šç”¨æˆ·åœ¨æ‰‹åŠ¨è¿æ¥ä¸¤ä¸ªä¸é€šçš„ç³»ç»Ÿï¼ˆå¦‚ï¼š"I have to copy-paste data from X to Y daily"ï¼‰ã€‚
*   **Hiring Humans**ï¼šç”¨æˆ·é›‡äººæ¥åšæœ¬è¯¥è‡ªåŠ¨åŒ–çš„äº‹ï¼ˆå¦‚ï¼š"I hired a VA just to do this"ï¼‰ã€‚
*   **Scripting**ï¼šéå¼€å‘è€…è¢«è¿«å†™è„šæœ¬è§£å†³é—®é¢˜ã€‚

### 2. è¯†åˆ« "æ˜‚è´µç—›è‹¦" (The Cost of Inaction)
ä¸è¦åªçœ‹ç”¨æˆ·æ˜¯å¦è¯´"æ„¿æ„ä»˜è´¹"ï¼Œè¦åˆ†æé—®é¢˜é€ æˆçš„**éšæ€§æˆæœ¬**ï¼š
*   **æ”¶å…¥æŸå¤±**ï¼š"I lost a client because of this..."
*   **åˆè§„é£é™©**ï¼š"I'm worried about GDPR/fines..."
*   **æé«˜çš„æ—¶é—´æˆæœ¬**ï¼š"This takes me 4 hours every week."

### 3. è¯†åˆ« "ç«å“ç¼ºå£" (The Competitor Gap)
å½“ç”¨æˆ·æåˆ°ç«å“æ—¶ï¼Œé‡ç‚¹å…³æ³¨**"ä½†æ˜¯" (But)** åé¢çš„å†…å®¹ï¼š
*   "Tool X is great, **but** it's too expensive for small teams." (ä»·æ ¼/åˆ†å±‚ç¼ºå£)
*   "Tool Y has feature A, **but** lacks feature B which is critical." (åŠŸèƒ½ç¼ºå£)
*   "Tool Z is powerful, **but** the UI is from the 90s." (ä½“éªŒç¼ºå£)

---

## ğŸ“‹ ä¿¡å·è¯†åˆ«æŒ‡å—

| ä¿¡å·å¼ºåº¦ | å…³é”®è¯/æ¨¡å¼ | å•†ä¸šä»·å€¼è§£è¯» |
|---------|------------|-------------|
| **ğŸ”¥ æå¼º** | "I'm currently using Excel/Zapier to hack this..." | ç”¨æˆ·å·²æŠ•å…¥æˆæœ¬è§£å†³ï¼Œæ€¥éœ€æ­£è§„ SaaS æ›¿ä»£ |
| **ğŸ”¥ æå¼º** | "I keep getting fined/banned because..." | æ¶‰åŠé‡‘é’±æŸå¤±æˆ–ç”Ÿå­˜é£é™©ï¼Œä»˜è´¹æ„æ„¿æé«˜ |
| **ğŸ”´ å¼º** | "Why is there no tool for X?" | å¸‚åœºç©ºç™½ï¼Œä½†éœ€éªŒè¯å¸‚åœºè§„æ¨¡ |
| **ğŸ”´ å¼º** | "I hate [Competitor] because..." | æ˜ç¡®çš„æ›¿ä»£æœºä¼š |
| **ğŸŸ¡ ä¸­** | "How do you guys handle X?" | å¯»æ‰¾æœ€ä½³å®è·µï¼Œå¯èƒ½æ˜¯æ•™è‚²æœºä¼šè€Œéå·¥å…·æœºä¼š |

---

## âš ï¸ æ™ºèƒ½è¿‡æ»¤ä¸é˜²å¹»è§‰

1.  **åŒºåˆ† "æƒ³è¦" (Want) å’Œ "éœ€è¦" (Need)**ï¼š
    *   ç”¨æˆ·è¯´ï¼š"æˆ‘æƒ³è¦ä¸€ä¸ªèƒ½å¯¼å‡º PDF çš„æŒ‰é’®" (Want)
    *   å®é™…éœ€æ±‚ï¼š"æˆ‘éœ€è¦å‘å®¢æˆ·å±•ç¤ºä¸“ä¸šçš„æœˆåº¦æŠ¥å‘Š" (Need) -> ä¹Ÿè®¸è‡ªåŠ¨å‘é€é‚®ä»¶æŠ¥å‘Šæ›´å¥½ã€‚
    *   **è¡ŒåŠ¨**ï¼šåœ¨ `user_need` å­—æ®µä¸­è®°å½•æ·±å±‚éœ€æ±‚ã€‚

2.  **æ’é™¤æ— æ•ˆå™ªéŸ³**ï¼š
    *   æ’é™¤ï¼šçº¯ç²¹çš„æƒ…ç»ªå®£æ³„è€Œæ— å…·ä½“åœºæ™¯ã€‚
    *   æ’é™¤ï¼šå¯»æ‰¾ç›—ç‰ˆ/ç ´è§£è½¯ä»¶çš„è¯·æ±‚ï¼ˆä»˜è´¹æ„æ„¿ä½ï¼‰ã€‚
    *   æ’é™¤ï¼šæå…¶åˆå­¦è€…çš„é—®é¢˜ï¼ˆå¦‚ "Python æ˜¯ä»€ä¹ˆ"ï¼‰ï¼Œé™¤éæ˜¯å¤§è§„æ¨¡çš„åˆå­¦è€…ç—›ç‚¹ï¼ˆå¦‚ "Python ç¯å¢ƒé…ç½®å¤ªéš¾äº†"ï¼‰ã€‚

---

## ğŸ” è¯„åˆ†ç³»ç»Ÿå‡çº§ç‰ˆ

åœ¨åŸæœ‰è¯„åˆ†åŸºç¡€ä¸Šï¼Œè¯·é‡‡ç”¨ä»¥ä¸‹æ›´ä¸¥æ ¼çš„æ ‡å‡†ï¼š

*   **Monetization (å˜ç°æ½œåŠ›)**ï¼š
    *   **10åˆ†**ï¼šé—®é¢˜ç›´æ¥å¯¼è‡´ç”¨æˆ·**èµ”é’±**æˆ–**æ³•å¾‹é£é™©**ï¼›æˆ–è€…ç”¨æˆ·æ˜ç¡®è¡¨ç¤º "I pay $500/m for a consultant to do this"ã€‚
    *   **8-9åˆ†**ï¼šé—®é¢˜æ¶‰åŠæ ¸å¿ƒä¸šåŠ¡æµç¨‹ï¼ˆé”€å”®ã€æœåŠ¡å™¨ã€æ”¯ä»˜ï¼‰ï¼Œä¸€æ—¦å‡ºé”™åæœä¸¥é‡ã€‚
    *   **1-3åˆ†**ï¼šä¸ªäººå…´è¶£çˆ±å¥½ã€ä¸€æ¬¡æ€§ä»»åŠ¡ã€ç”¨æˆ·æ˜ç¡®å¯»æ‰¾å¼€æº/å…è´¹æ–¹æ¡ˆã€‚

*   **Market Size (å¸‚åœºè§„æ¨¡)**ï¼š
    *   **åŠ åˆ†é¡¹**ï¼šé—®é¢˜å…·æœ‰**è·¨è¡Œä¸šé€šç”¨æ€§**ï¼ˆå¦‚ï¼šæ‰€æœ‰é”€å”®éƒ½éœ€è¦ï¼Œæ‰€æœ‰å¼€å‘è€…éƒ½éœ€è¦ï¼‰ã€‚
    *   **å‡åˆ†é¡¹**ï¼šé—®é¢˜ä»…é™äºæå…¶ç‰¹å®šçš„æŠ€æœ¯æ ˆç‰ˆæœ¬ï¼ˆå¦‚ï¼šä»…åœ¨ Windows 7 ä¸Šè¿è¡Œçš„æŸå¤è€è½¯ä»¶çš„æ’ä»¶ï¼‰ã€‚

---

## ğŸ“ è¾“å‡ºè¦æ±‚

1.  **è¯­è¨€**ï¼šä¸¥æ ¼ä½¿ç”¨**ç®€ä½“ä¸­æ–‡**ã€‚
2.  **æ ¼å¼**ï¼šä¸¥æ ¼éµå¾ª JSON æ ¼å¼ã€‚
3.  **ç—›ç‚¹æè¿° (Description)**ï¼šè¯·ä½¿ç”¨ **"åœºæ™¯ + éšœç¢ + åæœ"** çš„ç»“æ„ã€‚
    *   *å·®*ï¼šç”¨æˆ·éœ€è¦ä¸€ä¸ªæ›´å¥½çš„ CRMã€‚
    *   *å¥½*ï¼šä½œä¸º**ç‹¬ç«‹é”€å”®é¡¾é—®**ï¼Œåœ¨**ç®¡ç† 50+ æ½œåœ¨å®¢æˆ·**æ—¶ï¼Œ**ç°æœ‰çš„ CRM å¤ªè¿‡å¤æ‚ä¸”æ˜‚è´µ**ï¼Œå¯¼è‡´**èŠ±è´¹å¤§é‡æ—¶é—´å½•å…¥æ•°æ®è€Œä¸æ˜¯é”€å”®**ã€‚
4.  **è¡ŒåŠ¨å»ºè®® (Actionable Insights)**ï¼šå¿…é¡»åŒ…å«é’ˆå¯¹ç‹¬ç«‹å¼€å‘è€…çš„å…·ä½“å»ºè®®ï¼ˆå¦‚ï¼š"å¼€å‘ä¸€ä¸ª Chrome æ’ä»¶æ¥..."ï¼Œ"æ„å»ºä¸€ä¸ªè½»é‡çº§çš„..."ï¼‰ã€‚
5.  **åŒè¯­å¼•ç”¨**ï¼šquotes éœ€åŒæ—¶æä¾›è‹±æ–‡åŸæ–‡å’Œä¸­æ–‡ç¿»è¯‘ã€‚

è¯·ä¸¥æ ¼æŒ‰ç…§ç”¨æˆ·æç¤ºè¯ä¸­æŒ‡å®šçš„ JSON æ ¼å¼è¿›è¡Œå“åº”ã€‚"""


# ============================================================================
# è¡Œä¸šåˆ†ç±»åˆ—è¡¨
# ============================================================================

INDUSTRY_LIST = """å¯ç”¨çš„è¡Œä¸šåˆ†ç±»ï¼š
- DEV_TOOLS: å¼€å‘è€…å·¥å…·ï¼ˆIDEã€è°ƒè¯•å·¥å…·ã€å¼€å‘æ•ˆç‡å·¥å…·ï¼‰
- DEVOPS: DevOpsï¼ˆCI/CDã€ç›‘æ§ã€éƒ¨ç½²å·¥å…·ï¼‰
- DATA: æ•°æ®ä¸åˆ†æï¼ˆæ•°æ®åº“ã€BIã€æ•°æ®å¤„ç†ï¼‰
- SAAS: SaaS é€šç”¨ï¼ˆé€šç”¨ SaaS äº§å“ï¼‰
- MARKETING: è¥é”€ï¼ˆè¥é”€è‡ªåŠ¨åŒ–ã€SEOã€ç¤¾äº¤åª’ä½“ï¼‰
- SALES: é”€å”®ï¼ˆCRMã€é”€å”®è‡ªåŠ¨åŒ–ï¼‰
- PRODUCTIVITY: æ•ˆç‡å·¥å…·ï¼ˆç¬”è®°ã€ä»»åŠ¡ç®¡ç†ã€åä½œï¼‰
- FINANCE: è´¢åŠ¡ï¼ˆè®°è´¦ã€å‘ç¥¨ã€è´¢åŠ¡ç®¡ç†ï¼‰
- HR: äººåŠ›èµ„æºï¼ˆæ‹›è˜ã€å‘˜å·¥ç®¡ç†ï¼‰
- SECURITY: å®‰å…¨ï¼ˆç½‘ç»œå®‰å…¨ã€èº«ä»½è®¤è¯ï¼‰
- ECOMMERCE: ç”µå•†ï¼ˆåœ¨çº¿é”€å”®ã€æ”¯ä»˜ï¼‰
- COMMUNICATION: é€šè®¯ï¼ˆé‚®ä»¶ã€å³æ—¶é€šè®¯ï¼‰
- DESIGN: è®¾è®¡ï¼ˆUI/UX è®¾è®¡å·¥å…·ï¼‰
- AI_ML: AI/MLï¼ˆäººå·¥æ™ºèƒ½ã€æœºå™¨å­¦ä¹ ï¼‰
- OTHER: å…¶ä»–ï¼ˆæœªå½’ç±»ï¼‰"""


# ============================================================================
# ç—›ç‚¹ç±»å‹åˆ—è¡¨
# ============================================================================

PAIN_POINT_TYPE_LIST = """å¯ç”¨çš„ç—›ç‚¹ç±»å‹ï¼š
- MISSING_FEATURE: åŠŸèƒ½ç¼ºå¤±ï¼ˆäº§å“ç¼ºå°‘ç”¨æˆ·éœ€è¦çš„åŠŸèƒ½ï¼‰
- POOR_UX: ä½“éªŒä¸ä½³ï¼ˆç°æœ‰äº§å“éš¾ä»¥ä½¿ç”¨ï¼‰
- HIGH_COST: æˆæœ¬è¿‡é«˜ï¼ˆä»·æ ¼æˆ–èµ„æºæ¶ˆè€—è¿‡é«˜ï¼‰
- EFFICIENCY: æ•ˆç‡ä½ä¸‹ï¼ˆå·¥ä½œæµç¨‹æ•ˆç‡é—®é¢˜ï¼‰
- INTEGRATION: é›†æˆå›°éš¾ï¼ˆç³»ç»Ÿé—´æ— æ³•æ‰“é€šï¼‰
- RELIABILITY: ç¨³å®šæ€§å·®ï¼ˆäº§å“ä¸ç¨³å®šæˆ– Bug å¤šï¼‰
- PERFORMANCE: æ€§èƒ½é—®é¢˜ï¼ˆé€Ÿåº¦æ…¢ã€èµ„æºå ç”¨é«˜ï¼‰
- LEARNING_CURVE: å­¦ä¹ æˆæœ¬é«˜ï¼ˆéš¾ä»¥ä¸Šæ‰‹ï¼‰
- NO_SOLUTION: æ— è§£å†³æ–¹æ¡ˆï¼ˆå¸‚åœºä¸Šæ²¡æœ‰ç›¸å…³äº§å“ï¼‰
- OTHER: å…¶ä»–ï¼ˆæœªå½’ç±»ï¼‰"""


# ============================================================================
# è¯„åˆ†æŒ‡å—
# ============================================================================

SCORING_GUIDE = """## è¯„åˆ†æŒ‡å—

å„ç»´åº¦è¯„åˆ†èŒƒå›´ä¸º 1-10 åˆ†ï¼š

### urgencyï¼ˆç´§è¿«ç¨‹åº¦ï¼‰
ç”¨æˆ·å¯¹è§£å†³æ–¹æ¡ˆçš„è¿«åˆ‡ç¨‹åº¦ã€‚
- 1-3åˆ†ï¼šå¯æœ‰å¯æ— ï¼Œ"would be nice", "someday"
- 4-6åˆ†ï¼šä¸€èˆ¬éœ€æ±‚ï¼Œ"looking for", "wondering"
- 7-9åˆ†ï¼šæ€¥éœ€è§£å†³ï¼Œ"frustrated", "urgent", "hate"
- 10åˆ†ï¼šæåº¦ç´§è¿«ï¼Œ"critical", "blocking", "can't work"

**åŠ åˆ†ä¿¡å·**ï¼šç”¨æˆ·ä½¿ç”¨å¼ºçƒˆæƒ…ç»ªè¯ã€æè¿°é—®é¢˜é˜»ç¢å·¥ä½œ
**å‡åˆ†ä¿¡å·**ï¼šä»…æ˜¯å¥½å¥‡è¯¢é—®ã€æ— æ—¶é—´å‹åŠ›

### frequencyï¼ˆå‘ç”Ÿé¢‘ç‡ï¼‰
é—®é¢˜åœ¨ç”¨æˆ·æ—¥å¸¸å·¥ä½œä¸­å‡ºç°çš„é¢‘ç‡ã€‚
- 1-3åˆ†ï¼šå¶å°”å‡ºç°ï¼Œ"once in a while", "rarely"
- 4-6åˆ†ï¼šç»å¸¸å‡ºç°ï¼Œ"often", "regularly"
- 7-9åˆ†ï¼šæ¯å¤©å‡ºç°ï¼Œ"every day", "constantly"
- 10åˆ†ï¼šæŒç»­å­˜åœ¨ï¼Œ"always", "every time"

**åŠ åˆ†ä¿¡å·**ï¼šç”¨æˆ·æè¿°é‡å¤æ€§å·¥ä½œæµã€è‡ªåŠ¨åŒ–éœ€æ±‚
**å‡åˆ†ä¿¡å·**ï¼šä¸€æ¬¡æ€§ä»»åŠ¡ã€ç‰¹æ®Šåœºæ™¯

### market_sizeï¼ˆå¸‚åœºè§„æ¨¡ï¼‰
æœ‰å¤šå°‘äººå¯èƒ½é¢ä¸´åŒæ ·çš„é—®é¢˜ã€‚
- 1-3åˆ†ï¼šå°ä¼—éœ€æ±‚ï¼Œä¸“ä¸šç»†åˆ†é¢†åŸŸæˆ–ç‰¹å®šæŠ€æœ¯æ ˆç‰ˆæœ¬
- 4-6åˆ†ï¼šä¸­ç­‰å¸‚åœºï¼Œç‰¹å®šèŒä¸šç¾¤ä½“
- 7-9åˆ†ï¼šå¤§ä¼—éœ€æ±‚ï¼Œé€šç”¨å·¥å…·
- 10åˆ†ï¼šæ™®ééœ€æ±‚ï¼Œå‡ ä¹æ‰€æœ‰å¼€å‘è€…éƒ½ä¼šé‡åˆ°

**åŠ åˆ†ä¿¡å·**ï¼šè¯„è®ºåŒºæœ‰å¤šäººå…±é¸£ï¼ˆ"same here", "+1"ï¼‰ã€é—®é¢˜å…·æœ‰è·¨è¡Œä¸šé€šç”¨æ€§
**å‡åˆ†ä¿¡å·**ï¼šè¯„è®ºä¸­æœ‰è´¨ç–‘ã€éœ€æ±‚åœºæ™¯è¿‡äºç‰¹æ®Šï¼ˆå¦‚ä»…é™ç‰¹å®šæ—§ç‰ˆæœ¬è½¯ä»¶ï¼‰

### monetizationï¼ˆå˜ç°æ½œåŠ›ï¼‰
ç”¨æˆ·æ˜¯å¦æ„¿æ„ä¸ºè§£å†³æ–¹æ¡ˆä»˜è´¹ï¼Œæˆ–ä¸è§£å†³è¯¥é—®é¢˜æ˜¯å¦ä¼šé€ æˆæŸå¤±ã€‚
- 1-3åˆ†ï¼šä»˜è´¹æ„æ„¿ä½ï¼Œå…è´¹æ›¿ä»£å“å¤šï¼Œä¸ªäººå…´è¶£ä¸ºä¸»
- 4-6åˆ†ï¼šæœ‰ä»˜è´¹å¯èƒ½ï¼Œæ„¿æ„å°è¯•ï¼Œèƒ½æé«˜æ•ˆç‡
- 7-9åˆ†ï¼šä»˜è´¹æ„æ„¿é«˜ï¼Œæ¶‰åŠæ ¸å¿ƒä¸šåŠ¡æµç¨‹ï¼Œä¸€æ—¦å‡ºé”™åæœä¸¥é‡
- 10åˆ†ï¼šå¼ºçƒˆä»˜è´¹æ„æ„¿ï¼Œé—®é¢˜ç›´æ¥å¯¼è‡´èµ”é’±æˆ–æ³•å¾‹é£é™©ï¼Œæˆ–å·²ä»˜è´¹è¯·äººè§£å†³

**åŠ åˆ†ä¿¡å·**ï¼šç”¨æˆ·æåŠæ„¿æ„ä»˜è´¹ã€æåˆ°é¢„ç®—ã€B2B åœºæ™¯ã€æ¶‰åŠåˆè§„/ç½šæ¬¾
**å‡åˆ†ä¿¡å·**ï¼šç”¨æˆ·æ˜ç¡®è¦å…è´¹æ–¹æ¡ˆã€ä¸ªäººç”¨æˆ·ä¸ºä¸»ã€å¯»æ‰¾ç ´è§£ç‰ˆ

### barrier_to_entryï¼ˆå‡†å…¥é—¨æ§›ï¼‰
è¯¥æœºä¼šçš„ç«äº‰å£å’ã€‚æ³¨æ„ï¼šæˆ‘ä»¬å€¾å‘äºå¯»æ‰¾ 4-7 åˆ†çš„æœºä¼šï¼Œé¿å…çº¢æµ·ã€‚
- 1-3åˆ†ï¼šæä½é—¨æ§›ï¼Œå‘¨æœ«é¡¹ç›®å³å¯å®Œæˆï¼Œææ˜“è¢«å¤åˆ¶
- 4-6åˆ†ï¼šä¸­ç­‰é—¨æ§›ï¼Œéœ€è¦é¢†åŸŸçŸ¥è¯†æˆ–æ•°æ®ç§¯ç´¯
- 7-9åˆ†ï¼šè¾ƒé«˜é—¨æ§›ï¼Œéœ€è¦æ·±åšæŠ€æœ¯èƒŒæ™¯
- 10åˆ†ï¼šæé«˜é—¨æ§›ï¼Œéœ€è¦ç§‘ç ”çº§çªç ´

**ç†æƒ³åŒºé—´**ï¼š4-7 åˆ†ï¼ˆæœ‰ä¸€å®šå£å’ä½†ç‹¬ç«‹å¼€å‘è€…å¯å®ç°ï¼‰"""


# ============================================================================
# JSON å“åº”æ ¼å¼æ¨¡æ¿
# ============================================================================

JSON_FORMAT_TEMPLATE = """{
  "is_pain_point": trueæˆ–false,
  "confidence": 0.0-1.0ä¹‹é—´çš„ç½®ä¿¡åº¦,
  "reason": "ç®€è¦è¯´æ˜ä½ çš„åˆ¤æ–­ç†ç”±ï¼ˆä¸­æ–‡ï¼‰",
  "pain_point": {
    "title": "ä¸€å¥è¯æ¦‚æ‹¬ç—›ç‚¹ï¼ˆä¸­æ–‡ï¼‰",
    "description": "ç—›ç‚¹çš„è¯¦ç»†æè¿°ï¼ˆä¸­æ–‡ï¼‰",
    "user_need": "ç”¨æˆ·å®é™…éœ€è¦ä»€ä¹ˆï¼ˆä¸­æ–‡ï¼‰",
    "current_solution": "ç”¨æˆ·ç›®å‰å¦‚ä½•å¤„ç†è¿™ä¸ªé—®é¢˜ï¼ˆä¸­æ–‡ï¼Œå¦‚æœ‰æåŠï¼‰",
    "ideal_solution": "ç”¨æˆ·æœŸæœ›çš„è§£å†³æ–¹æ¡ˆï¼ˆä¸­æ–‡ï¼Œå¦‚æœ‰æåŠï¼‰",
    "industry_code": "ä¸Šè¿°è¡Œä¸šåˆ†ç±»ä¸­çš„ä»£ç ",
    "type_code": "ä¸Šè¿°ç—›ç‚¹ç±»å‹ä¸­çš„ä»£ç ",
    "tags": ["ç›¸å…³", "æ ‡ç­¾", "æœ€å¤š5ä¸ª", "ä¸­æ–‡"],
    "mentioned_competitors": ["ç«å“1", "ç«å“2"],
    "quotes": [
      {
        "en": "åŸæ–‡å¼•ç”¨1ï¼ˆä¿ç•™è‹±æ–‡åŸæ–‡ï¼‰",
        "zh": "åŸæ–‡å¼•ç”¨1çš„ä¸­æ–‡ç¿»è¯‘"
      },
      {
        "en": "åŸæ–‡å¼•ç”¨2ï¼ˆä¿ç•™è‹±æ–‡åŸæ–‡ï¼‰",
        "zh": "åŸæ–‡å¼•ç”¨2çš„ä¸­æ–‡ç¿»è¯‘"
      }
    ],
    "target_personas": ["ç›®æ ‡è§’è‰²1ï¼ˆä¸­æ–‡ï¼‰", "ç›®æ ‡è§’è‰²2"],
    "actionable_insights": ["è¡ŒåŠ¨å»ºè®®1ï¼ˆä¸­æ–‡ï¼‰", "è¡ŒåŠ¨å»ºè®®2"],
    "scores": {
      "urgency": {
        "score": 1-10åˆ†,
        "reason": "è¯„åˆ†ç†ç”±ï¼ˆä¸­æ–‡ï¼‰"
      },
      "frequency": {
        "score": 1-10åˆ†,
        "reason": "è¯„åˆ†ç†ç”±ï¼ˆä¸­æ–‡ï¼‰"
      },
      "market_size": {
        "score": 1-10åˆ†,
        "reason": "è¯„åˆ†ç†ç”±ï¼ˆä¸­æ–‡ï¼‰"
      },
      "monetization": {
        "score": 1-10åˆ†,
        "reason": "è¯„åˆ†ç†ç”±ï¼ˆä¸­æ–‡ï¼‰"
      },
      "barrier_to_entry": {
        "score": 1-10åˆ†,
        "reason": "è¯„åˆ†ç†ç”±ï¼ˆä¸­æ–‡ï¼‰"
      }
    }
  }
}

æ³¨æ„ï¼šå¦‚æœ is_pain_point ä¸º falseï¼Œpain_point å­—æ®µåº”ä¸º nullã€‚"""


# ============================================================================
# ç”¨æˆ·æç¤ºè¯æ¨¡æ¿
# ============================================================================

USER_PROMPT_TEMPLATE = """è¯·åˆ†æä»¥ä¸‹ Reddit å¸–å­ï¼ŒæŒ–æ˜å…¶ä¸­çš„ç”¨æˆ·éœ€æ±‚å’Œç—›ç‚¹ã€‚

## å¸–å­ä¿¡æ¯
- ç¤¾åŒº: r/{subreddit}
- æ ‡é¢˜: {title}
- å†…å®¹:
{content}
- å¾—åˆ†: {score}
- è¯„è®ºæ•°: {num_comments}

## çƒ­é—¨è¯„è®º
{top_comments}

## åˆ†ææç¤º
è¯·ç‰¹åˆ«æ³¨æ„ä»¥ä¸‹æ–¹é¢ï¼š
1. **æ ‡é¢˜æš—ç¤º**ï¼šå¸–å­æ ‡é¢˜æš—ç¤ºäº†ä»€ä¹ˆéœ€æ±‚ï¼Ÿæ˜¯æ±‚åŠ©ã€æŠ±æ€¨è¿˜æ˜¯è®¨è®ºï¼Ÿ
2. **è¯„è®ºå…±é¸£**ï¼šè¯„è®ºä¸­æ˜¯å¦æœ‰å…±é¸£ä¿¡å·ï¼ˆsame/+1/me tooï¼‰ï¼Ÿæœ‰å¤šå°‘äººæœ‰ç±»ä¼¼ç»å†ï¼Ÿ
3. **ç«å“ä¿¡æ¯**ï¼šæ˜¯å¦æœ‰äººæåˆ°ç°æœ‰å·¥å…·çš„ä¸è¶³æˆ–æ¨èæ›¿ä»£æ–¹æ¡ˆï¼Ÿ
4. **ç”¨æˆ·èƒŒæ™¯**ï¼šå‘å¸–è€…çš„èŒä¸šèƒŒæ™¯æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆå½±å“åœºæ™¯ç†è§£å’Œä»˜è´¹èƒ½åŠ›åˆ¤æ–­ï¼‰
5. **éšæ€§éœ€æ±‚**ï¼šç”¨æˆ·è¡¨é¢é—®é¢˜èƒŒåï¼ŒçœŸæ­£çš„éœ€æ±‚æ˜¯ä»€ä¹ˆï¼Ÿ

## è¡Œä¸šåˆ†ç±»
{industry_list}

## ç—›ç‚¹ç±»å‹
{type_list}

{scoring_guide}

## å“åº”æ ¼å¼
è¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹ JSON æ ¼å¼å“åº”ï¼Œä¸è¦æ·»åŠ ä»»ä½•é¢å¤–æ–‡å­—ï¼š

```json
{json_format}
```

è¯·å¼€å§‹åˆ†æå¸–å­ï¼š"""


def build_user_prompt(
    subreddit: str,
    title: str,
    content: str,
    score: int,
    num_comments: int,
    top_comments: str,
) -> str:
    """
    æ„å»ºç”¨æˆ·æç¤ºè¯
    
    Args:
        subreddit: ç¤¾åŒºåç§°
        title: å¸–å­æ ‡é¢˜
        content: å¸–å­å†…å®¹
        score: å¸–å­å¾—åˆ†
        num_comments: è¯„è®ºæ•°
        top_comments: æ ¼å¼åŒ–çš„çƒ­é—¨è¯„è®º
        
    Returns:
        å®Œæ•´çš„ç”¨æˆ·æç¤ºè¯
    """
    # å¤„ç†ç©ºå†…å®¹
    if not content or content.strip() == "":
        content = "ï¼ˆæ— æ­£æ–‡å†…å®¹ï¼Œä»…æœ‰æ ‡é¢˜ï¼‰"
    
    if not top_comments or top_comments.strip() == "":
        top_comments = "ï¼ˆæ— çƒ­é—¨è¯„è®ºï¼‰"
    
    return USER_PROMPT_TEMPLATE.format(
        subreddit=subreddit,
        title=title,
        content=content,
        score=score,
        num_comments=num_comments,
        top_comments=top_comments,
        industry_list=INDUSTRY_LIST,
        type_list=PAIN_POINT_TYPE_LIST,
        scoring_guide=SCORING_GUIDE,
        json_format=JSON_FORMAT_TEMPLATE,
    )


def format_comments(comments: list[str], max_total_chars: int = 5000) -> str:
    """
    æ ¼å¼åŒ–è¯„è®ºåˆ—è¡¨ï¼ˆå¸¦é•¿åº¦é™åˆ¶ï¼‰
    
    Args:
        comments: è¯„è®ºå†…å®¹åˆ—è¡¨
        max_total_chars: è¯„è®ºæ€»å­—ç¬¦æ•°ä¸Šé™ï¼ˆé»˜è®¤ 5000ï¼‰
        
    Returns:
        æ ¼å¼åŒ–çš„è¯„è®ºå­—ç¬¦ä¸²
    """
    if not comments:
        return "ï¼ˆæ— çƒ­é—¨è¯„è®ºï¼‰"
    
    formatted = []
    total_chars = 0
    truncated = False
    
    for i, comment in enumerate(comments, 1):
        # æˆªæ–­å•æ¡è¿‡é•¿çš„è¯„è®ºï¼ˆä¿ç•™ 800 å­—ç¬¦ä»¥å®¹çº³åµŒå¥—å›å¤ï¼‰
        if len(comment) > 800:
            comment = comment[:800] + "..."
        
        # è®¡ç®—æ·»åŠ æ­¤è¯„è®ºåçš„æ€»é•¿åº¦
        comment_text = f"{i}. {comment}"
        new_total = total_chars + len(comment_text) + 1  # +1 for newline
        
        # æ£€æŸ¥æ˜¯å¦è¶…è¿‡æ€»é•¿åº¦é™åˆ¶
        if new_total > max_total_chars:
            truncated = True
            break
        
        formatted.append(comment_text)
        total_chars = new_total
    
    result = "\n".join(formatted)
    
    # å¦‚æœè¢«æˆªæ–­ï¼Œæ·»åŠ æç¤º
    if truncated:
        remaining = len(comments) - len(formatted)
        result += f"\n[... è¿˜æœ‰ {remaining} æ¡è¯„è®ºå› é•¿åº¦é™åˆ¶è¢«çœç•¥]"
    
    return result if formatted else "ï¼ˆæ— çƒ­é—¨è¯„è®ºï¼‰"